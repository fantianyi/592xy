<?phpclass umbrella_blogroll_widget extends WP_Widget{	function umbrella_blogroll_widget() 	{		parent::WP_Widget(false, $name = 'Umbrella > Blogroll');	}		function widget($args, $instance)	{		extract( $args );		$title = apply_filters('widget_title', $instance['title']);		$category = $instance['category'];		$num_of_posts = $instance['num_of_posts'];		$arguments = array();		if($num_of_posts > 1)			$arguments["limit"] = intval($num_of_posts);		if($category != "any" || $category != '')			$arguments["category"] = $category;		$links = get_bookmarks($arguments);		?>		<div class="blogroll col_300 footer_col">			<h3><?php echo $title; ?></h3>			<ul>				<?php foreach($links as $link): ?>					<li><a href="<?php echo $link->link_url; ?>"><?php echo $link->link_name; ?></a></li>				<?php endforeach; ?>			</ul>		</div><!--Close Blogroll-->		<?php	}		function update($new_instance, $old_instance)	{		$instance = $old_instance;		$instance['title'] = strip_tags($new_instance['title']);		$instance['category'] = strip_tags($new_instance['category']);		$instance['num_of_posts'] = strip_tags($new_instance['num_of_posts']);		return $instance;	}		function form($instance)	{		$title = isset($instance['title']) ? esc_attr($instance['title']) : "";		$category = isset($instance['category']) ? esc_attr($instance['category']) : "";		$num_of_posts = isset($instance['num_of_posts']) ? esc_attr($instance['num_of_posts']) : "";		?>		<p>			<label for="<?php echo $this->get_field_id('title'); ?>"><?php _e('Widget Title'); ?></label>			<input class="widefat" id="<?php echo $this->get_field_id('title'); ?>" name="<?php echo $this->get_field_name('title'); ?>" type="text" value="<?php echo $title; ?>" />		</p>		<p>			<label for="<?php echo $this->get_field_id('category'); ?>"><?php _e('Links Category'); ?></label>			<select id="<?php echo $this->get_field_id('category'); ?>" name="<?php echo $this->get_field_name('category'); ?>" value="<?php echo $category; ?>">				<option value="any"><?php _e("All Categories"); ?></option>				<option disabled="disabled">----</option>				<?php					$link_categories = get_terms("link_category",array("hide_empty"=>false));					foreach($link_categories as $link_category):					if($link_category->term_id == $category)						$selected = "selected='selected'";					else						$selected = "";					?>						<option <?php echo $selected; ?> value="<?php echo $link_category->term_id; ?>"><?php echo $link_category->name; ?></option>					<?php					endforeach;				?>			</select>		</p>		<p>			<label for="<?php echo $this->get_field_id('num_of_posts'); ?>"><?php _e('Number of posts (Leave blank for unlimited)'); ?></label>			<input class="widefat" id="<?php echo $this->get_field_id('num_of_posts'); ?>" name="<?php echo $this->get_field_name('num_of_posts'); ?>" type="text" value="<?php echo $num_of_posts; ?>" />		</p>		<?php	}}function register_umbrella_blogroll_widget() {				register_widget('umbrella_blogroll_widget');			}add_action('widgets_init', 'register_umbrella_blogroll_widget');?>